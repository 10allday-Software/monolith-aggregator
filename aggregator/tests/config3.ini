[monolith]
timeout = 10
sequence = extract, load
history = sqlite:///%(here)s/history.db

[phase:extract]
sources = ga, somesql, solitude, marketplace
targets = sql

[phase:load]
sources = sql
targets = elasticsearch

[source:somesql]
id = somesql
use = aggregator.plugins.sqlread.SQLRead
database = sqlite:///%(here)s/source.db
query = select * from downloads where _date BETWEEN :start_date and :end_date

[source:ga]
id = ga
use = aggregator.tests.test_extract.get_ga_fails
metrics = ga:pageviews
dimensions = browser
oauth_token = %(here)s/auth.json
profile_id = 67582515

[target:sql]
id = sql
use = aggregator.plugins.sqlwrite.SQLInjecter
database = sqlite:///%(here)s/target.db

[target:elasticsearch]
id = elasticsearch
use = aggregator.tests.test_extract.put_es_failing
url = http://es/is/here

[source:solitude]
id = solitude
use = aggregator.tests.test_extract.get_rest
url = http://solitude.service/get_stats

[source:marketplace]
id = mkt
use = aggregator.tests.test_extract.get_market_place

[source:sql]
id = sql
use = aggregator.plugins.sqlread.SQLRead
database = sqlite:///%(here)s/target.db
query = select id AS _id, type AS _type, date, value from record where date BETWEEN :start_date and :end_date

