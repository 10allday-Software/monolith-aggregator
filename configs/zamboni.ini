[monolith]
timeout = 10
sequence = extract
history = mysql+pymysql://monolith:monolith@localhost/monolith

[phase:extract]
sources = mkt-installs
targets = stdout

[phase:load]
sources = sql
targets = es, stdout

[source:mkt-installs]
id = mkt-app-installs
category = installs
use = aggregator.plugins.zamboni.GetAppInstalls
endpoint = http://addons.mozilla.dev:8000/api/monolith/data/
password = this is a test
username = monolith@mozilla.com

[source:sql]
id = sql
use = aggregator.plugins.sqlread.SQLRead
database = pymysql://monolith:monolith@localhost/monolith
query = select id AS _id, type AS _type, date, value from record where date BETWEEN :start_date and :end_date

[target:file]
use = aggregator.plugins.files.FileWriter
filename = toto.test
id = file

[target:sql]
id = sql
use = aggregator.plugins.sqlwrite.SQLInjecter
database = mysql+pymysql://monolith:monolith@localhost/monolith

[target:es]
id = es
use = aggregator.plugins.es.ESWrite
url = http://localhost:9200

[target:stdout]
id = stdout
use = aggregator.plugins.std.Out
